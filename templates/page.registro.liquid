{% comment %}
  STEP 1: Migrant Registration Form
  This section is embedded as page content in Shopify Pages > registro
  OR used as a standalone section in the page template.
{% endcomment %}

<h1 class="sc-page-title">¡Cuida a tu familia hoy!</h1>
<p class="sc-page-subtitle">
  Primero cuéntanos de ti.<br>
  <strong style="color: var(--cyan);">Primer mes completamente gratis.</strong>
</p>

<form class="sc-form" id="form-step1" action="/pages/familia" method="post" onsubmit="handleStep1(event)">

  <p class="sc-section-title">Tus datos — Estás en EE.UU.</p>

  <div class="sc-field">
    <label class="sc-label" for="nombre">Tu nombre completo *</label>
    <input class="sc-input" type="text" id="nombre" name="nombre" placeholder="Juan García López" required>
  </div>

  <div class="sc-field">
    <label class="sc-label" for="email">Tu correo electrónico *</label>
    <input class="sc-input" type="email" id="email" name="email" placeholder="juan@gmail.com" required>
  </div>

  <div class="sc-field">
    <label class="sc-label" for="telefono">Tu número de WhatsApp (EE.UU.) *</label>
    <input class="sc-input" type="tel" id="telefono" name="telefono" placeholder="+1 (555) 123-4567" required>
  </div>

  <div class="sc-field">
    <label class="sc-label" for="estado">¿En qué estado vives?</label>
    <select class="sc-select" id="estado" name="estado">
      <option value="">Selecciona tu estado</option>
      <option value="AZ">Arizona</option>
      <option value="CA">California</option>
      <option value="TX">Texas</option>
      <option value="FL">Florida</option>
      <option value="IL">Illinois</option>
      <option value="NY">New York</option>
      <option value="NV">Nevada</option>
      <option value="CO">Colorado</option>
      <option value="WA">Washington</option>
      <option value="NC">North Carolina</option>
      <option value="GA">Georgia</option>
      <option value="NJ">New Jersey</option>
      <option value="otro">Otro estado</option>
    </select>
  </div>

  <div class="sc-field">
    <label class="sc-label" for="plan">Elige tu plan *</label>
    <select class="sc-select" id="plan" name="plan" required onchange="updatePlanDisplay()">
      <option value="basico" selected>Básico — $12/mes · Hasta 4 personas</option>
      <option value="premium">Premium — $18/mes · Hasta 4 personas + terapia semanal</option>
    </select>
  </div>

  <!-- Plan Summary -->
  <div class="sc-summary">
    <p class="sc-summary-title">Resumen de tu plan</p>
    <div class="sc-summary-row">
      <span class="sc-summary-label">Hoy pagas</span>
      <span class="sc-summary-value free">$0.00 — GRATIS</span>
    </div>
    <div class="sc-summary-row">
      <span class="sc-summary-label" id="plan-name-label">Plan Básico</span>
      <span class="sc-summary-value price" id="plan-price-label">$12/mes</span>
    </div>
    <div class="sc-summary-row">
      <span class="sc-summary-label">Primer cobro</span>
      <span class="sc-summary-value">En 30 días</span>
    </div>
    <div class="sc-summary-row">
      <span class="sc-summary-label">Personas cubiertas</span>
      <span class="sc-summary-value">Hasta 4 en México</span>
    </div>
  </div>

  <button type="submit" class="cta-primary" style="animation: none;">
    Continuar — Agregar mi familia
  </button>

  <div class="cta-subtext">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
      <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
    </svg>
    Datos protegidos con encriptación de 256 bits
  </div>

</form>

<script>
function updatePlanDisplay() {
  const plan = document.getElementById('plan').value;
  const nameLabel = document.getElementById('plan-name-label');
  const priceLabel = document.getElementById('plan-price-label');
  if (plan === 'premium') {
    nameLabel.textContent = 'Plan Premium';
    priceLabel.textContent = '$18/mes';
  } else {
    nameLabel.textContent = 'Plan Básico';
    priceLabel.textContent = '$12/mes';
  }
}

function handleStep1(e) {
  e.preventDefault();
  const form = document.getElementById('form-step1');
  const data = {
    nombre: document.getElementById('nombre').value,
    email: document.getElementById('email').value,
    telefono: document.getElementById('telefono').value,
    estado: document.getElementById('estado').value,
    plan: document.getElementById('plan').value
  };
  // Save to sessionStorage to pass between pages
  sessionStorage.setItem('sc_step1', JSON.stringify(data));
  window.location.href = '/pages/familia';
}
</script>

{% schema %}
{
  "name": "Registro Step 1",
  "settings": []
}
{% endschema %}
